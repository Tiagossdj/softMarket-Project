-- Banco de Dados para Teste de API

CREATE TABLE IF NOT EXISTS fornecedor (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    cnpj VARCHAR(14) NOT NULL UNIQUE,
    contato VARCHAR(100) NOT NULL
);

CREATE TABLE IF NOT EXISTS produto (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    preco FLOAT NOT NULL,
    quantidade_em_estoque INT NOT NULL,
    fornecedor_id INT NOT NULL,
    CONSTRAINT fk_fornecedor FOREIGN KEY (fornecedor_id) REFERENCES fornecedor(id)
);

-- TABELA CLIENTE REMOVIDA

CREATE TABLE IF NOT EXISTS compra (
    id SERIAL PRIMARY KEY,
    data TIMESTAMP NOT NULL,
    total FLOAT NOT NULL
);

CREATE TABLE IF NOT EXISTS pedido_estoque (
    id SERIAL PRIMARY KEY,
    produto_id INT NOT NULL,
    quantidade INT NOT NULL,
    fornecedor_id INT NOT NULL,
    CONSTRAINT fk_produto FOREIGN KEY (produto_id) REFERENCES produto(id),
    CONSTRAINT fk_fornecedor_pedido FOREIGN KEY (fornecedor_id) REFERENCES fornecedor(id)
);

CREATE TABLE IF NOT EXISTS item_compra (
    id SERIAL PRIMARY KEY,
    compra_id INT,
    produto_id INT NOT NULL,
    quantidade INT NOT NULL,
    preco_unitario FLOAT NOT NULL,
    subtotal FLOAT NOT NULL,
    CONSTRAINT fk_compra FOREIGN KEY (compra_id) REFERENCES compra(id),
    CONSTRAINT fk_produto_item FOREIGN KEY (produto_id) REFERENCES produto(id)
);
